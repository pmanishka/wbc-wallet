<!DOCTYPE html>
<html>
<head>
<title>World Bank of Cryptocurrencies</title>
<link rel="stylesheet" type="text/css" href="css/style.css">
<script src="js/jquery.min.js"></script>

<script>
var contentType ="application/x-www-form-urlencoded; charset=utf-8";
if(window.XDomainRequest){contentType = "text/plain";}
jQuery.support.cors = true;


jQuery(document).ready(function() {
var username = localStorage.getItem("username");
//alert(username);

	jQuery('.otp-verify').hide();
	jQuery('.arrow-button input[name="submit"]').click(function(){
		var mobile = jQuery('#mobileno').val();
		jQuery('.mobileresult').empty();
		//var otpres= '';
			$.ajax({
			  url: "http://10.0.0.66/Regular/cryptocurrency/api/registerationMobileVerification",
			  type: 'POST',
			  data: {q:'verify_mobile',mobile:mobile}, 
			  crossDomain: true,   
			  success: function(data) {
				if(data['status'] == 1)
				{
					var otpval= (data['otp']);
					
					jQuery('.otp-verify').show();
					jQuery('.mobileresult').append(mobile);
					localStorage.setItem('mobile', mobile);
					
					var otpres = jQuery('input[name="otp-verify"]').val();
					
					jQuery('input[name="otp-verify"]').change(function() {
						var otpres = jQuery('input[name="otp-verify"]').val();
						if(otpres == otpval){
							window.location='reg-step3.html';
						}else{
							alert('Please check otp again else resend otp');
						}
					});
					
				}else{
					alert('verification failed');
				}
			  },
			  error: function() {
				 alert('Failed');
			  }
		});
		//alert(otpres);
			
	});
		
});

</script>
</head>
<body>

<div id="main_wrapper" class="inner-page">
	<div class="main-container">
	<div id="topbar">
		Step 2
	</div>
	<div id="top_header">
		<div class="logo">
			<div class="logo-img"><img src="images/gif_logo.gif"></div>
			<div class="logo-text">World Bank of Cryptocurrencies</div>
		</div>
	</div>
	<div class="container">
		<div class="registertop">
			2. Mobile Verification
		</div>
		<div class="register-form">
			<form method="post">
				<div class="mobile-label">
					<label>Enter Mobile Verification</label>
				</div>
				<div class="mobile-verify">
					<div class="mobilecode">
						<input type="text" readonly value="+91"/>
					</div>
					<div class="mobile-input-field">
						<input type="text" name="mobileno" id="mobileno" maxlength="10"/>
					</div>
					<div class="input-button arrow-button">
						<input type="button" name="submit" value="Send OTP"/>
					</div>	
				</div>
				<div class="verification-text">
					For your verification and update.
				</div>
				<div class="otp-verify">
					<div class="otp-msg">OTP is send to given number <span class="mobileresult"></span></div>
					<div class="otp-textbox"><input class="otp-input" type="password" name="otp-verify" maxlength="4"/></div>
					<div class="otp-resend"><img src="images/refresh.png">Resend OTP</div>
				</div>
			</form>
		</div>
	</div>
</div>
</body>
</html>